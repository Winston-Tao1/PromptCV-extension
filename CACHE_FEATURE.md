# 缓存功能说明文档

## 功能概述

"缓存"功能已从原来的云同步模式完全升级为**纯本地存储模式**，专注于为用户提供便捷的本地数据缓存服务。

## 核心特性

### 1. 纯本地存储
- ✅ **无云同步**: 所有数据仅保存在浏览器本地存储（Chrome Local Storage）
- ✅ **本设备专用**: 缓存数据仅在当前设备可用，不会跨设备同步
- ✅ **隐私安全**: 数据不会上传到任何云端服务器

### 2. 任意格式支持
- ✅ **无限制格式**: 用户可以上传任意格式的文件
- ✅ **多文件上传**: 支持一次性上传多个文件
- ✅ **支持的文件类型包括但不限于**:
  - 文档: txt, doc, docx, pdf, md
  - 表格: xls, xlsx, csv
  - 演示: ppt, pptx
  - 图片: jpg, png, gif, svg
  - 压缩包: zip, rar, 7z
  - 代码: js, py, java, html, css, json
  - 音视频: mp3, wav, mp4, avi, mkv
  - 其他任意格式

### 3. 自动保存机制
- ✅ **实时自动保存**: 编辑内容后1秒自动保存到本地
- ✅ **无需手动操作**: 系统自动检测内容变化并保存
- ✅ **仪式感保存**: 底部保存按钮触发手动保存，提供视觉反馈

### 4. 富文本编辑
- ✅ 加粗、下划线、背景色高亮
- ✅ 多种字体选择（包括中文字体）
- ✅ 有序/无序列表
- ✅ 粘贴图片支持
- ✅ 混合格式内容

### 5. 无限制存储
- ✅ **默认无上限**: Chrome Local Storage 理论上可存储大量数据
- ✅ **手动清理**: 用户可在输入框中直接删除内容清理缓存
- ✅ **文件管理**: 每个上传的文件都有独立的删除按钮

## 使用方法

### 添加文本内容
1. 点击"缓存"标签页
2. 在编辑器中输入或粘贴任意文本内容
3. 使用工具栏格式化文本（可选）
4. 内容会自动在1秒后保存到本地

### 上传文件
1. 点击"📤 上传文件"按钮
2. 选择一个或多个任意格式的文件
3. 文件会立即显示为缩略图
4. 自动保存到本地缓存

### 粘贴图片
1. 从其他应用复制图片
2. 在编辑器中粘贴（Ctrl+V 或 Cmd+V）
3. 图片会显示为可删除的缩略图
4. 自动保存到本地缓存

### 清理缓存
- **删除文本**: 直接在编辑器中选中并删除文字
- **删除文件**: 点击文件缩略图右上角的"×"按钮
- **删除图片**: 点击图片右上角的"×"按钮
- 所有修改都会自动保存

### 手动保存
点击底部的"保存"按钮，会显示提示"✓ 已保存到本地缓存"，提供仪式感反馈。

## 技术细节

### 存储方式
- 使用 `chrome.storage.local` API 进行本地存储
- 文件以 Base64 编码格式存储
- 支持大文件存储（相比 sync storage 有更大的空间限制）

### 数据结构
```javascript
cacheData: {
    content: '',           // HTML格式的编辑器内容
    files: [],            // 文件数组（未来扩展用）
    lastModified: null    // 最后修改时间戳
}
```

### 自动保存触发条件
- 编辑器内容变化（input 事件）
- 粘贴图片
- 上传文件
- 删除文件/图片
- 1秒防抖延迟

## 与原"云盘"功能的区别

| 特性 | 原云盘功能 | 新缓存功能 |
|------|-----------|-----------|
| 存储位置 | Chrome Sync Storage (云端) | Chrome Local Storage (本地) |
| 跨设备同步 | ✓ 支持 | ✗ 不支持 |
| 文件格式限制 | 限制少数格式 | 支持任意格式 |
| 存储空间 | 受限（约100KB） | 更大（约5-10MB） |
| 多文件上传 | ✗ 单文件 | ✓ 多文件 |
| 自动保存延迟 | 2秒 | 1秒 |
| 数据隐私 | 云端存储 | 仅本地存储 |

## 注意事项

⚠️ **重要提醒**:
1. 缓存数据仅保存在当前浏览器的本地存储中
2. 清除浏览器数据会导致缓存丢失
3. 卸载扩展会导致缓存丢失
4. 不同浏览器/设备之间的数据不会同步
5. 建议定期备份重要数据到外部文件

## 浏览器兼容性

- ✅ Chrome 88+
- ✅ Edge 88+
- ✅ 其他 Chromium 内核浏览器

## 更新日志

### v2.0.0 (2025-12-29)
- 🎉 "云盘"功能重构为"缓存"功能
- ✨ 移除所有云同步功能
- ✨ 改用 Chrome Local Storage 实现纯本地存储
- ✨ 支持任意格式文件上传
- ✨ 支持多文件同时上传
- ✨ 优化自动保存机制（2秒→1秒）
- ✨ 扩展文件图标支持（新增20+种文件类型）
- ✨ 改进用户提示文案
- 📝 更新功能文档

---

*最后更新时间: 2025-12-29*
